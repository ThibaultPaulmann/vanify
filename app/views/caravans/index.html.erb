<div class="caravans-index">
  <div class="bar">
    <h1>Current listing:</h1>
    <%= link_to "Add a listing", new_caravan_path , class: "btn btn-danger" %>
  </div>

  <div style="width: 100%; height: 600px;"
    data-controller="map"
    data-map-markers-value="<%= @markers.to_json %>"
    data-map-api-key-value="<%= ENV['MAPBOX_API_KEY'] %>">
  </div>

  <div class="listings">
    <% @caravans.each do |caravan| %>
      <div class="listing">
        <div class="image-container">
          <% if caravan.photos.attached? %>
            <%= link_to caravan_path(caravan) do %>
              <% caravan.photos.each do |photo| %>
                <div class="photo-img" style="background-image: url('<%= cl_image_path photo.key, crop: :fill %>')"></div>
              <% end %>
            <% end %>
          <% end %>
        </div>
        <div class="description">
          <div class="naming">
            <h4><%= link_to caravan.model, caravan_path(caravan), class: "a" %></h4>
            <p><%= caravan.location %></p>
          </div>
          <div class="right">
            <h5>â‚¬ <%= caravan.price.to_i %></h5>
            <p><i class="fa-solid fa-user"></i> <%= caravan.capacity %></p>
          </div>
        </div>
      </div>
    <% end %>
  </div>
</div>
